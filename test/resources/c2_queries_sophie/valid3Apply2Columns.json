{
	"title": "3 APPLY 2 COLUMNs",
	"input": {
		"WHERE": {},
		"OPTIONS": {
			"COLUMNS": [
				"rooms_lon",
				"rooms_lat",
				"sumSeats",
				"avgSeats"
			],
			"ORDER": {
				"dir": "DOWN",
				"keys": [
					"sumSeats"
				]
			}
		},
		"TRANSFORMATIONS": {
			"GROUP": [
				"rooms_lon",
				"rooms_lat"
			],
			"APPLY": [
				{
					"sumSeats": {
						"SUM": "rooms_seats"
					}
				},
				{
					"countLon": {
						"COUNT": "rooms_lon"
					}
				},
				{
					"avgSeats": {
						"AVG": "rooms_seats"
					}
				}
			]
		}
	},
	"errorExpected": false,
	"expected": [
		{
			"rooms_lon": -123.25468,
			"rooms_lat": 49.26826,
			"sumSeats": 3190,
			"avgSeats": 52.3
		},
		{
			"rooms_lon": -123.25364,
			"rooms_lat": 49.26486,
			"sumSeats": 1546,
			"avgSeats": 55.21
		},
		{
			"rooms_lon": -123.25431,
			"rooms_lat": 49.26293,
			"sumSeats": 1421,
			"avgSeats": 64.59
		},
		{
			"rooms_lon": -123.24673,
			"rooms_lat": 49.26478,
			"sumSeats": 1297,
			"avgSeats": 81.06
		},
		{
			"rooms_lon": -123.2531,
			"rooms_lat": 49.26398,
			"sumSeats": 1004,
			"avgSeats": 45.64
		},
		{
			"rooms_lon": -123.25308,
			"rooms_lat": 49.2659,
			"sumSeats": 913,
			"avgSeats": 152.17
		},
		{
			"rooms_lon": -123.24894,
			"rooms_lat": 49.2683,
			"sumSeats": 897,
			"avgSeats": 299
		},
		{
			"rooms_lon": -123.24494,
			"rooms_lat": 49.26236,
			"sumSeats": 825,
			"avgSeats": 275
		},
		{
			"rooms_lon": -123.24944,
			"rooms_lat": 49.26048,
			"sumSeats": 662,
			"avgSeats": 31.52
		},
		{
			"rooms_lon": -123.25374,
			"rooms_lat": 49.26627,
			"sumSeats": 658,
			"avgSeats": 109.67
		},
		{
			"rooms_lon": -123.24886,
			"rooms_lat": 49.26044,
			"sumSeats": 621,
			"avgSeats": 62.1
		},
		{
			"rooms_lon": -123.25623,
			"rooms_lat": 49.26605,
			"sumSeats": 619,
			"avgSeats": 77.38
		},
		{
			"rooms_lon": -123.25224,
			"rooms_lat": 49.26274,
			"sumSeats": 580,
			"avgSeats": 193.33
		},
		{
			"rooms_lon": -123.25027,
			"rooms_lat": 49.26114,
			"sumSeats": 573,
			"avgSeats": 30.16
		},
		{
			"rooms_lon": -123.2521,
			"rooms_lat": 49.26766,
			"sumSeats": 568,
			"avgSeats": 31.56
		},
		{
			"rooms_lon": -123.24342,
			"rooms_lat": 49.26229,
			"sumSeats": 538,
			"avgSeats": 48.91
		},
		{
			"rooms_lon": -123.25165,
			"rooms_lat": 49.2661,
			"sumSeats": 537,
			"avgSeats": 134.25
		},
		{
			"rooms_lon": -123.24467,
			"rooms_lat": 49.26047,
			"sumSeats": 521,
			"avgSeats": 173.67
		},
		{
			"rooms_lon": -123.25533,
			"rooms_lat": 49.26545,
			"sumSeats": 505,
			"avgSeats": 126.25
		},
		{
			"rooms_lon": -123.24935,
			"rooms_lat": 49.26176,
			"sumSeats": 503,
			"avgSeats": 83.83
		},
		{
			"rooms_lon": -123.255534,
			"rooms_lat": 49.266463,
			"sumSeats": 495,
			"avgSeats": 61.88
		},
		{
			"rooms_lon": -123.24807,
			"rooms_lat": 49.26125,
			"sumSeats": 440,
			"avgSeats": 88
		},
		{
			"rooms_lon": -123.24937,
			"rooms_lat": 49.26517,
			"sumSeats": 427,
			"avgSeats": 213.5
		},
		{
			"rooms_lon": -123.25314,
			"rooms_lat": 49.26207,
			"sumSeats": 426,
			"avgSeats": 426
		},
		{
			"rooms_lon": -123.24718,
			"rooms_lat": 49.26228,
			"sumSeats": 354,
			"avgSeats": 118
		},
		{
			"rooms_lon": -123.25249,
			"rooms_lat": 49.26479,
			"sumSeats": 336,
			"avgSeats": 84
		},
		{
			"rooms_lon": -123.25583,
			"rooms_lat": 49.26767,
			"sumSeats": 325,
			"avgSeats": 54.17
		},
		{
			"rooms_lon": -123.24894,
			"rooms_lat": 49.26273,
			"sumSeats": 289,
			"avgSeats": 48.17
		},
		{
			"rooms_lon": -123.24959,
			"rooms_lat": 49.26414,
			"sumSeats": 263,
			"avgSeats": 43.83
		},
		{
			"rooms_lon": -123.2559,
			"rooms_lat": 49.264,
			"sumSeats": 240,
			"avgSeats": 30
		},
		{
			"rooms_lon": -123.25318,
			"rooms_lat": 49.2699,
			"sumSeats": 228,
			"avgSeats": 45.6
		},
		{
			"rooms_lon": -123.25505,
			"rooms_lat": 49.2643,
			"sumSeats": 201,
			"avgSeats": 28.71
		},
		{
			"rooms_lon": -123.25741,
			"rooms_lat": 49.26958,
			"sumSeats": 186,
			"avgSeats": 46.5
		},
		{
			"rooms_lon": -123.24842,
			"rooms_lat": 49.2642,
			"sumSeats": 166,
			"avgSeats": 27.67
		},
		{
			"rooms_lon": -123.25692,
			"rooms_lat": 49.26867,
			"sumSeats": 163,
			"avgSeats": 40.75
		},
		{
			"rooms_lon": -123.24608,
			"rooms_lat": 49.26541,
			"sumSeats": 160,
			"avgSeats": 160
		},
		{
			"rooms_lon": -123.25042,
			"rooms_lat": 49.27106,
			"sumSeats": 150,
			"avgSeats": 75
		},
		{
			"rooms_lon": -123.25099,
			"rooms_lat": 49.26372,
			"sumSeats": 144,
			"avgSeats": 144
		},
		{
			"rooms_lon": -123.25179,
			"rooms_lat": 49.26176,
			"sumSeats": 142,
			"avgSeats": 47.33
		},
		{
			"rooms_lon": -123.254816,
			"rooms_lat": 49.266089,
			"sumSeats": 106,
			"avgSeats": 106
		},
		{
			"rooms_lon": -123.25237,
			"rooms_lat": 49.26862,
			"sumSeats": 94,
			"avgSeats": 47
		},
		{
			"rooms_lon": -123.2466,
			"rooms_lat": 49.2663,
			"sumSeats": 65,
			"avgSeats": 32.5
		},
		{
			"rooms_lon": -123.25198,
			"rooms_lat": 49.26228,
			"sumSeats": 50,
			"avgSeats": 50
		},
		{
			"rooms_lon": -123.25655,
			"rooms_lat": 49.2666,
			"sumSeats": 41,
			"avgSeats": 20.5
		}
	]
}
